# 0G Web3 DeFi Template - LLM Context

This is a COMPLETE Web3 DeFi application template for 0G Network with working swap interface.

---

## ⚠️ CRITICAL: THIS IS A PRE-CONFIGURED TEMPLATE

**DO NOT run any of these commands - they will fail:**
- `npx shadcn init` - Already configured (components.json exists)
- `npm create vite` - Project already exists
- `npx create-next-app` - Not a Next.js project
- Full `npm install` with new dependencies (use existing ones)

**This template is READY TO USE. Only make targeted edits to:**
- `.env` file (for config values)
- `src/config/*.ts` files (for settings)
- `src/components/*.tsx` files (for UI changes)
- `main.tsx` (for feature flags via FeatureProvider)

---

## ⚠️ CRITICAL: DO NOT BREAK THESE FILES

These files have required exports that other files depend on. **NEVER remove or rename these exports:**

### src/config/theme.ts - REQUIRED EXPORTS (ALL MUST EXIST):
```typescript
export const BRAND_COLORS = { ... }        // Used by components
export const RAINBOWKIT_THEME = { ... }    // Used by main.tsx, wagmi.ts
export const DESIGN_TOKENS = { ... }       // Used by main.tsx, components
export const ANIMATION_CONFIG = { ... }    // Used by AnimatedBackground
export type BrandColors = typeof BRAND_COLORS
export type DesignTokens = typeof DESIGN_TOKENS
```

**If you modify theme.ts for ANY reason (color change, etc.), you MUST include ALL exports above.**

### src/config/wagmi.ts - REQUIRED EXPORTS:
```typescript
export const config = getDefaultConfig({ ... })
export { RAINBOWKIT_THEME as rainbowTheme } from './theme'
```

### src/hooks/index.ts - DO NOT DELETE
This barrel file exports all hooks. Only ADD to it, never remove exports.

### src/config/index.ts - DO NOT DELETE
This barrel file exports all config. Only ADD to it, never remove exports.

---

## CRITICAL: Import Patterns

### Hooks (use barrel export)
```typescript
import { useSwap, usePools, usePortfolio, useChartData } from '@/hooks'
```

### Config (use barrel export)
```typescript
import { BRAND_COLORS, DEFAULT_FEATURES, zgMainnet } from '@/config'
```

### Features (from provider - includes utilities)
```typescript
import { FeatureProvider, mergeFeatures, DEFAULT_FEATURES } from './providers/feature-provider'
```

---

## CRITICAL: Feature Request Handling

When user requests a feature, follow this decision flow:

### IF user wants CHARTS or POOL DATA:
1. Check if `VITE_SUBGRAPH_URL_MAINNET` is set in .env
2. If NOT set, ask: "Charts/pools require a subgraph URL. Do you have a Goldsky/Graph subgraph deployed? If not, the app will show demo data."
3. If they don't have one, charts will work with "Demo Data" badge shown

### IF user wants MOBILE WALLET support:
1. Check if `VITE_WALLETCONNECT_PROJECT_ID` is set
2. If NOT set, ask: "For mobile wallet connections, you need a WalletConnect Project ID from https://cloud.walletconnect.com - do you have one?"

### IF user wants ONLY SWAP (no pools/charts/portfolio):
Use `MINIMAL_FEATURES` preset in main.tsx:

```typescript
import { FeatureProvider, MINIMAL_FEATURES } from './providers/feature-provider'

<FeatureProvider config={MINIMAL_FEATURES}>
  <App />
</FeatureProvider>
```

### IF user wants to DISABLE a specific feature (pools, portfolio, chart):
**⚠️ USE FEATURE FLAGS - DO NOT delete files or modify theme.ts**

Edit ONLY `main.tsx` to pass config to FeatureProvider:

```typescript
import { FeatureProvider, mergeFeatures, DEFAULT_FEATURES } from './providers/feature-provider'

<FeatureProvider config={mergeFeatures(DEFAULT_FEATURES, {
  pools: { enabled: false },
  portfolio: { enabled: false },
})}>
  <App />
</FeatureProvider>
```

**This is the ONLY correct way to disable features. Do NOT:**
- Delete panel components
- Modify theme.ts
- Modify wagmi.ts
- Remove exports from barrel files

---

## THEME & BRANDING

### Changing Brand Colors

Edit `src/config/theme.ts`:

```typescript
export const BRAND_COLORS = {
  primary: '#8B5CF6',      // Main brand color (violet)
  secondary: '#ec4899',    // Accent color (pink)
  primaryForeground: '#ffffff',
  secondaryForeground: '#ffffff',
  background: {
    dark: '#0a0a0f',
    gradientStart: '#1a0533',
    gradientMid: '#2d1b4e',
    gradientEnd: '#0f172a',
  },
  success: '#10b981',
  error: '#ef4444',
  warning: '#f59e0b',
  info: '#3b82f6',
}
```

Then update `tailwind.config.js` primary/secondary color scales to match.

### CRITICAL: Tailwind Color Classes

| Purpose | Use This | NOT This |
|---------|----------|----------|
| Primary brand | `primary-500` | `violet-500` |
| Secondary accent | `secondary-500` | `fuchsia-500` |
| Gradients | `from-primary-500 to-secondary-500` | `from-violet-500 to-fuchsia-500` |
| Background | `bg-background-dark` | `bg-[#0a0a0f]` |

### Design Tokens

Available in `src/config/theme.ts` as `DESIGN_TOKENS`:
- Layout: `headerHeight`, `maxContentWidth`, `containerPadding`
- Timing: `transitionFast` (150ms), `transitionNormal` (200ms), `transitionSlow` (300ms)
- Refresh: `balanceRefresh` (15s), `priceRefresh` (30s), `poolRefresh` (60s)
- Border radius: `radiusSmall`, `radiusMedium`, `radiusLarge`, `radiusXLarge`

### RainbowKit Theme

Wallet modal styling is in `RAINBOWKIT_THEME` (uses `BRAND_COLORS.primary`).

---

## NETWORKS SUPPORTED

| Network | Chain ID | DEX | Subgraph | Mode |
|---------|----------|-----|----------|------|
| **Mainnet** | 16661 | Janie DEX (V3) | Optional | Real swaps |
| **Testnet** | 16602 | None | None | Demo only |

**Auto-behavior by chain:**
- Testnet: Pools auto-disabled, swap runs in demo mode
- No subgraph: Charts show demo data with warning badge

---

## ENVIRONMENT VARIABLES (.env)

Required for real chart/pool data:

    VITE_SUBGRAPH_URL_MAINNET=https://api.goldsky.com/api/public/...

Optional:

    VITE_SUBGRAPH_URL_TESTNET=       # Testnet subgraph (usually not available)
    VITE_WALLETCONNECT_PROJECT_ID=   # For mobile wallets (from cloud.walletconnect.com)
    VITE_ANALYTICS_ID=               # Analytics tracking

---

## FEATURE CONFIGURATION SYSTEM

### Feature Presets

**DEFAULT_FEATURES** - All features enabled (current default)
**MINIMAL_FEATURES** - Swap only, everything else disabled

### All Available Toggles

Located in `src/config/features.ts`:

    swap:
      enabled: boolean              // Show swap tab
      showChart: boolean            // Mini chart next to swap panel
      showPriceImpact: boolean      // Price impact percentage
      showNetworkFee: boolean       // Gas estimate (mainnet only)
      showMinReceived: boolean      // Minimum output after slippage

    pools:
      enabled: boolean              // Show pools tab
      showMyPositions: boolean      // User's LP positions
      allowCreatePool: boolean      // Create new pool button

    chart:
      enabled: boolean              // Show chart tab
      defaultTimeRange: '1H' | '24H' | '7D' | '30D' | '1Y'
      showMockDataWarning: boolean  // "Demo Data" badge

    portfolio:
      enabled: boolean              // Show portfolio tab
      showHoldings: boolean         // Token holdings list
      showActivity: boolean         // Recent transactions

    ui:
      showNetworkBadge: boolean     // Network indicator in header
      showFaucetLink: boolean       // Link to testnet faucet
      animatedBackground: boolean   // Gradient orb animation
      showMainnetWarning: boolean   // Real money warning on mainnet

---

## DEX CONTRACTS (Mainnet - Janie DEX)

| Contract | Address |
|----------|---------|
| Router | `0x8b598a7c136215a95ba0282b4d832b9f9801f2e2` |
| Factory | `0x9bdca5798e52e592a08e3b34d3f18eef76af7ef4` |
| W0G (Wrapped 0G) | `0x1cd0690ff9a693f5ef2dd976660a8dafc81a109c` |
| USDC.e | `0x1f3aa82227281ca364bfb3d253b0f1af1da6473e` |

---

## TOKENS CONFIGURATION

### Adding a New Token

Edit `src/constants/tokens.ts` with required fields:

    {
      address: '0x...',             // Contract address (use 'native' for 0G)
      symbol: 'TOKEN',              // Display symbol
      name: 'Token Name',           // Full name
      decimals: 18,                 // Token decimals (USDC = 6, most = 18)
      logoURI: '/tokens/token.svg', // Local path or https:// URL
    }

**Token Arrays by Chain:**
- `MAINNET_TOKENS` - Real tokens on mainnet
- `TESTNET_TOKENS` - Test tokens on testnet

---

## POOLS CONFIGURATION

### Known Pools (src/constants/pools.ts)

Example pool configuration:

    {
      address: '0xa9e824eddb9677fb2189ab9c439238a83695c091',
      token0: W0G_ADDRESS,
      token1: USDC_ADDRESS,
      fee: 3000,  // 0.3% fee tier (V3 format: 500=0.05%, 3000=0.3%, 10000=1%)
    }

### Featured Pools for Charts (src/config/subgraph.ts)

The `FEATURED_POOLS` array controls which pools appear in chart dropdown.

---

## DATA SOURCES

| Data Type | Source | Fallback |
|-----------|--------|----------|
| Token balances | On-chain (Wagmi) | - |
| Swap quotes | Pool contract slot0 | Mock rate |
| Pool TVL/Volume | Subgraph | Demo data |
| Price charts | Subgraph | Empty/Demo |
| Swap execution | Router contract | Demo mode (testnet) |

**"Demo Data" badge appears when:**
- No subgraph URL configured
- On testnet (no DEX)
- Subgraph query fails

---

## AVAILABLE HOOKS

All hooks importable from `@/hooks`:
```typescript
import { useSwap, usePools, usePortfolio } from '@/hooks'
```

| Hook | Purpose | Returns |
|------|---------|---------|
| `useSwap()` | Execute swaps | status, txHash, getQuote, executeSwap |
| `useSwapQuote()` | Get swap quotes | quote, isLoading, refetch |
| `usePools()` | Pool data | pools, isDexAvailable, isLoading |
| `useSubgraphPools()` | Top pools from subgraph | topPools, protocolStats |
| `usePortfolio()` | Holdings | holdings, totalValue, hasHoldings |
| `useChartData()` | Price charts | data (OHLC), isLoading, hasSubgraph |
| `useTokenList()` | Token browser | tokens, search, filter |
| `useTokenBalance()` | Single balance | balance, formatted |
| `useTokenPrices()` | Token prices | prices, isLoading |
| `useUserTransactions()` | Transaction history | transactions, isLoading |
| `useWalletConnection()` | Wallet state | isConnected, address, chainId |
| `useWalletInfo()` | Wallet meta | ens, avatar, displayName |
| `useFeatures()` | Feature config | All feature flags |
| `useFeatureEnabled()` | Single feature check | boolean |
| `useFrameworkReady()` | Init state | Framework ready boolean |
| `useToast()` | Toast notifications | toast function |

---

## COMPONENT STRUCTURE

### Feature Panels (src/components/web3/)
- `swap-panel.tsx` - Token swap interface
- `pools-panel.tsx` - Liquidity pool browser
- `chart-panel.tsx` - Price charts
- `portfolio-panel.tsx` - Token holdings

### Web3 Primitives (src/components/web3/)
- `TokenIcon`, `TokenBalance`, `TokenInput`, `TokenInputField`
- `TokenSelectModal`, `TokenSelect`
- `ConnectButton`, `NetworkBadge`, `AccountInfo`
- `ExplorerLink`, `TxStatusModal`
- `SwapSettings`, `SwapSettingsPanel`, `SwapCard`

### UI Components (src/components/ui/)
- `GlassCard`, `GlassButton`, `GlassInput` - Glassmorphism design
- `AnimatedBackground` - Gradient orbs
- `Shimmer` - Loading skeleton
- `GradientText`, `NumberFlow` - Text effects

### Naming Convention
- Feature panels: `[feature]-panel.tsx`
- All files: kebab-case
- To add new feature: create `web3/[name]-panel.tsx`, add to features.ts

---

## COMMON CUSTOMIZATIONS

| Request | Solution | ⚠️ DO NOT |
|---------|----------|-----------|
| "Remove pools/portfolio" | Use `mergeFeatures` in main.tsx with `enabled: false` | Delete files or modify theme.ts |
| "Swap only mode" | Use `MINIMAL_FEATURES` preset in main.tsx | Delete panel components |
| "Disable pools" | Set `pools: { enabled: false }` in FeatureProvider | Remove pool files |
| "Disable portfolio" | Set `portfolio: { enabled: false }` in FeatureProvider | Remove portfolio files |
| "Change colors" | Edit `src/config/theme.ts` BRAND_COLORS (keep ALL exports!) | Remove any exports |
| "Change gradient" | Edit BRAND_COLORS.primary/secondary in theme.ts | Use hardcoded hex values |
| "Add token" | Add to `src/constants/tokens.ts` | - |
| "Add pool" | Add to `src/constants/pools.ts` | - |
| "Change default network" | Edit `src/config/chains.ts` defaultChain | - |
| "Add new panel" | Create `web3/[name]-panel.tsx`, add tab in Header | - |
| "Custom slippage" | User sets in SwapSettings, default is 0.5% | - |
| "Change refresh rate" | Edit `DESIGN_TOKENS` in `src/config/theme.ts` | Remove DESIGN_TOKENS export |

---

## FILE STRUCTURE

    src/
    ├── config/
    │   ├── index.ts           # Barrel export - import { X } from '@/config'
    │   ├── theme.ts           # Brand colors, design tokens, RainbowKit theme
    │   ├── chains.ts          # Chain definitions (mainnet + testnet)
    │   ├── features.ts        # Feature toggle system
    │   ├── subgraph.ts        # Subgraph URLs and featured pools
    │   └── wagmi.ts           # Wallet configuration
    ├── constants/
    │   ├── contracts.ts       # DEX contract addresses
    │   ├── tokens.ts          # Token lists by network
    │   ├── pools.ts           # Pool configurations
    │   └── abis.ts            # Contract ABIs (V3 Router, ERC20, Pool)
    ├── hooks/
    │   ├── index.ts           # Barrel export - import { useX } from '@/hooks'
    │   └── use*.ts            # Individual hooks
    ├── services/
    │   └── subgraph.ts        # GraphQL queries for DEX data
    ├── providers/
    │   └── feature-provider.tsx  # Feature config context (re-exports utilities)
    └── components/
        ├── ui/                # Design system (Glass*, Shimmer, etc.)
        └── web3/              # All Web3 components

---

## TRANSACTION FLOW

### Swap Execution
1. User selects tokens and amount
2. Quote fetched from pool contract (slot0)
3. If token needs approval, approval transaction first
4. Swap transaction via router
5. TxStatusModal shows: pending, then success/error
6. Explorer link provided

### Settings
- **Slippage**: 0.1% - 50% (default 0.5%)
- **Deadline**: 1-60 minutes (default 20 min)

---

## NETWORK INFO

| | Mainnet | Testnet |
|---|---------|---------|
| Explorer | https://chainscan.0g.ai | https://chainscan-galileo.0g.ai |
| RPC | https://evmrpc.0g.ai | https://evmrpc-testnet.0g.ai |
| Faucet | - | https://faucet.0g.ai |
| Bridge | https://hub.0g.ai/bridge | - |

---

## SUBGRAPH SCHEMA

Uses Uniswap V3 compatible schema. Key entities:
- `Pool` - pool address, token0, token1, liquidity, sqrtPrice
- `PoolDayData` - daily OHLC, volume, TVL
- `PoolHourData` - hourly OHLC, volume
- `Token` - address, symbol, decimals, volume

---

For stock photos, use images from Pexels with valid URLs.
